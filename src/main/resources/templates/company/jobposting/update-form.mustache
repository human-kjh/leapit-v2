{{> layout/company-header}}

<div class="main container mt-5">
    <div class="container">
        <div class="bg-white p-5 rounded shadow">
            <h2 class="mb-4 fw-bold">채용 포지션 수정</h2>
            <form class="row g-4" action="/s/company/jobposting/{{model.id}}/update" method="post">
                <div class="col-md-6">
                    <label class="form-label">직무 <span class="text-danger">*</span></label>
                    <select class="form-select" name="positionType">
                        <option disabled {{^model.positionType}}selected{{/model.positionType}}>선택하세요</option>
                        {{#positionType}}
                            <option value="{{.}}">{{.}}</option>
                        {{/positionType}}
                    </select>
                </div>
                <div class="mb-3">
                    <div class="mb-3">
                        <label class="form-label">기술 스택 <span class="text-danger">*</span></label>
                        <div id="techStackCheckboxes">
                            {{#allTechStacks}}
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" name="techStacks" value="{{code}}"
                                           id="tech_{{code}}" {{#selected}}checked{{/selected}} />
                                    <label class="form-check-label" for="tech_{{code}}">{{code}}</label>
                                </div>
                            {{/allTechStacks}}
                        </div>
                    </div>
                    <div class="form-text">원하는 기술 스택을 모두 선택하세요</div>
                </div>

                <div class="col-12">
                    <div>포지션 제목 <span class="text-danger">*</span></div>
                    <textarea class="form-control" style="vertical-align: top; padding-top: 0.5rem" rows="3"
                              name="title" placeholder="서비스나 제품의 핵심이 되는 컴포넌트를 함께 만들며...">{{model.title}}</textarea>
                </div>

                <div class="col-md-6">
                    <div>포지션 마감일 <span class="text-danger">*</span></div>
                    <input type="date" class="form-control" name="deadline" value="{{model.deadline}}"/>
                </div>

                <div class="col-md-3">
                    <div>연차 (최소) <span class="text-danger">*</span></div>
                    <select class="form-select" name="minCareerLevel">
                        <option disabled selected>선택하세요</option>
                        <option value="0">신입</option>
                        <option value="1">1년</option>
                        <option value="2">2년</option>
                        <option value="3">3년</option>
                        <option value="4">4년</option>
                        <option value="5">5년</option>
                        <option value="6">6년</option>
                        <option value="7">7년</option>
                        <option value="8">8년</option>
                        <option value="9">9년</option>
                        <option value="10">10년 이상</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <div>연차 (최대) <span class="text-danger">*</span></div>
                    <select class="form-select" name="maxCareerLevel">
                        <option disabled selected>선택하세요</option>
                        <option value="0">신입</option>
                        <option value="1">1년</option>
                        <option value="2">2년</option>
                        <option value="3">3년</option>
                        <option value="4">4년</option>
                        <option value="5">5년</option>
                        <option value="6">6년</option>
                        <option value="7">7년</option>
                        <option value="8">8년</option>
                        <option value="9">9년</option>
                        <option value="10">10년 이상</option>
                    </select>
                </div>


                <div class="row g-3 align-items-end mt-3" style="max-width: 720px">
                    <div class="col-md-3">
                        <div>시/도 <span class="text-danger">*</span></div>
                        <select class="form-select" name="addressRegionId">
                            <option selected disabled>선택하세요</option>
                            {{#addressRegionList}}
                                <option value="{{regionId}}" {{#selected}}selected{{/selected}}>{{region}}</option>
                            {{/addressRegionList}}
                        </select>
                    </div>

                    <div class="col-md-3">
                        <div>시/군/구 <span class="text-danger">*</span></div>
                        <select class="form-select" id="addressSubRegion" name="addressSubRegionId">
                            <option disabled selected>선택하세요</option>
                            {{#addressSubRegionList}}
                                <option value="{{subRegionId}}">{{subRegion}}</option>
                            {{/addressSubRegionList}}
                        </select>
                    </div>

                    <div class="col-md-6">
                        <div>상세주소 <span class="text-danger">*</span></div>
                        <input class="form-control" name="addressDetail" placeholder="상세주소입력"
                               value="{{model.addressDetail}}"/>
                    </div>
                </div>

                <div class="col-12">
                    <div>서비스 소개</div>
                    <textarea class="form-control" name="serviceIntro"
                              placeholder="서비스에 대한 간략한 소개">{{model.serviceIntro}}</textarea>
                </div>

                <div class="col-12">
                    <div>담당 업무 <span class="text-danger">*</span></div>
                    <textarea class="form-control" name="responsibility"
                              placeholder="예: 프론트엔드 UI 개발">{{model.responsibility}}</textarea>
                </div>

                <div class="col-12">
                    <div>자격요건 <span class="text-danger">*</span></div>
                    <textarea class="form-control" name="qualification"
                              placeholder="예: React 경험 2년 이상">{{model.qualification}}</textarea>
                </div>

                <div class="col-12">
                    <div>학력 제한 <span class="text-danger">*</span></div>
                    <select class="form-select" name="educationLevel">
                        <option value="전체" {{#model.educationLevel}}selected{{/model.educationLevel}}>전체</option>
                        <option value="고등학교" {{#model.educationLevel}}selected{{/model.educationLevel}}>고등학교
                        </option>
                        <option value="전문학사" {{#model.educationLevel}}selected{{/model.educationLevel}}>전문학사
                        </option>
                        <option value="학사" {{#model.educationLevel}}selected{{/model.educationLevel}}>학사</option>
                        <option value="석사" {{#model.educationLevel}}selected{{/model.educationLevel}}>석사</option>
                        <option value="박사" {{#model.educationLevel}}selected{{/model.educationLevel}}>박사</option>
                    </select>
                </div>

                <div class="col-12">
                    <div>우대 사항</div>
                    <textarea class="form-control" name="preference"
                              placeholder="예: 오픈소스 기여 경험">{{model.preference}}</textarea>
                </div>

                <div class="col-12">
                    <div>복지및 혜택</div>
                    <textarea class="form-control" name="benefit"
                              placeholder="예: 점심 제공, 자율 출퇴근 등">{{model.benefit}}</textarea>
                </div>

                {{#model.additionalInfo}}
                    <div class="col-12">
                        <div>기타</div>
                        <textarea class="form-control" name="additionalInfo"
                                  placeholder="채용절차/지원방법 등">{{model.additionalInfo}}</textarea>
                    </div>
                {{/model.additionalInfo}}
                {{^model.additionalInfo}}
                    <div class="col-12">
                        <div>기타</div>
                        <textarea class="form-control" name="additionalInfo"
                                  placeholder="채용절차/지원방법 등"></textarea>
                    </div>
                {{/model.additionalInfo}}

                <div class="col-12">
                    <button type="submit" class="btn btn-primary w-100">수정하기</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const regionSelect = document.querySelector('select[name="addressRegionId"]');
        const subRegionSelect = document.querySelector('select[name="addressSubRegionId"]');

        regionSelect.addEventListener("change", function () {
            const selectedRegionId = this.value;

            // 하위 옵션 초기화
            subRegionSelect.innerHTML = '<option disabled selected>선택하세요</option>';

            // 서버로 서브 지역 요청
            fetch(`/api/region/subregions?regionId=${selectedRegionId}`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(subRegion => {
                            const option = document.createElement("option");
                            option.value = subRegion.subRegionId;
                            option.textContent = subRegion.subRegion;
                            subRegionSelect.appendChild(option);
                        });
                    })
                    .catch(error => console.error("서브 지역 로딩 실패:", error));
        });
    });
</script>


{{> layout/footer}}